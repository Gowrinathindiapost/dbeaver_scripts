SELECT
    '<?xml version="1.0" encoding="UTF-8"?>' ||
    '<LatestEventDetails>' ||
    arrayStringConcat(
        arrayMap(
            x -> '<ArticleDetails>' ||
                '<ArticleNumber>' || toString(x.1) || '</ArticleNumber>' ||
                '<ArticleType>' || upper(toString(x.2)) || '</ArticleType>' ||
                '<BookingDate>' || toString(x.3) || '</BookingDate>' ||
                '<BookingTime>' || toString(x.4) || '</BookingTime>' ||
                '<BookingOfficeFacilityID>' || upper(toString(x.5)) || '</BookingOfficeFacilityID>' ||
                '<BookingOfficeName>' || upper(toString(x.6)) || '</BookingOfficeName>' ||
                '<BookingPIN>' || toString(x.7) || '</BookingPIN>' ||
                '<SenderAddressCity>' || upper(toString(x.8)) || '</SenderAddressCity>' ||
                '<DestinationOfficeFacilityID>' || upper(toString(x.9)) || '</DestinationOfficeFacilityID>' ||
                '<DestinationOfficeName>' || upper(toString(x.10)) || '</DestinationOfficeName>' ||
                '<DestinationPIN>' || toString(x.11) || '</DestinationPIN>' ||
                '<DestinationCity>' || upper(toString(x.12)) || '</DestinationCity>' ||
                '<DestinationCountry>' || upper(toString(x.13)) || '</DestinationCountry>' ||
                '<ReceiverName>' || upper(replaceRegexpAll(toString(x.14), '[^a-zA-Z0-9 ]', '')) || '</ReceiverName>' ||
                '<InvoiceNo>' || toString(x.15) || '</InvoiceNo>' ||
                '<LineItem/>' ||
                '<WeightValue>' || toString(x.16) || '</WeightValue>' ||
                '<Tariff>' || toString(x.17) || '</Tariff>' ||
                '<CODAmount>' || toString(x.18) || '</CODAmount>' ||
                '<BookingType>' || upper(toString(x.19)) || '</BookingType>' ||
                '<ContractNumber>' || toString(x.20) || '</ContractNumber>' ||
                '<Refrence/>' ||
                '<EventCode>' || upper(toString(x.21)) || '</EventCode>' ||
                '<EventDescription>' || upper(toString(x.22)) || '</EventDescription>' ||
                '<EventOfficeFacilityID>' || upper(toString(x.23)) || '</EventOfficeFacilityID>' ||
                '<EventOfficeName>' || upper(toString(x.24)) || '</EventOfficeName>' ||
                '<EventDate>' || toString(x.25) || '</EventDate>' ||
                '<EventTime>' || toString(x.26) || '</EventTime>' ||
                '<NonDelReason>' || upper(toString(x.27)) || '</NonDelReason>' ||
                '</ArticleDetails>',
            groupArray((
                article_number,
                article_type,
                booking_date,
                booking_time,
                booking_office_facility_id,
                booking_office_name,
                booking_pin,
                sender_address_city,
                destination_office_facility_id,
                destination_office_name,
                destination_pincode,
                destination_city,
                destination_country,
                receiver_name,
                invoice_no,
                weight_value,
                tariff,
                cod_amount,
                booking_type,
                contract_number,
                event_code,
                event_description,
                event_office_facility_id,
                office_name,
                event_date,
                event_time,
                ifNull(non_delivery_reason, '')
            ))
        )
    ) ||
    '</LatestEventDetails>' AS xml_output
FROM (
    SELECT DISTINCT
        cxcm.article_number, 
        cxcm.article_type,
        formatDateTime(cxcm.booking_date, '%d%m%Y') AS booking_date,
        formatDateTime(cxcm.booking_time, '%H%i%s') AS booking_time,
        cxcm.booking_office_facility_id,
        cxcm.booking_office_name, 
        cxcm.booking_pin, 
        cxcm.sender_address_city, 
        cxcm.destination_office_facility_id,
        cxcm.destination_office_name, 
        cxcm.destination_pincode, 
        cxcm.destination_city, 
        cxcm.destination_country,
        cxcm.receiver_name, 
        cxcm.invoice_no, 
        cxcm.weight_value, 
        cxcm.tariff, 
        cxcm.cod_amount,
        cxcm.booking_type, 
        cxcm.contract_number, 
        cxcm.bulk_customer_id,
        formatDateTime(te.event_date, '%d%m%Y') AS event_date,
        formatDateTime(toDateTime(te.event_date), '%H%i%s') AS event_time,  -- Extract time from event_date
        te.event_code,
        te.office_id AS event_office_facility_id,
        te.office_name,
        te.event_type AS event_description,
        te.delivery_status AS non_delivery_reason,
        ROW_NUMBER() OVER (PARTITION BY cxcm.article_number ORDER BY te.event_date DESC) AS rn  -- Removed event_time from ordering
    FROM mis_db.new_customer_xml_facility_customer_mv AS cxcm
    INNER JOIN (
        SELECT 
            t1.article_number, 
            t1.event_date, 
            t1.event_type, 
            t1.event_code,
            t1.office_id, 
            t1.office_name, 
            t1.delivery_status
        FROM mis_db.new_customer_tracking_event_mv AS t1
        INNER JOIN (
            SELECT 
                article_number, 
                max(event_date) AS max_event_date
            FROM mis_db.new_customer_tracking_event_mv
            GROUP BY article_number
        ) AS t2 ON t1.article_number = t2.article_number 
                AND t1.event_date = t2.max_event_date
    ) te ON cxcm.article_number = te.article_number
    WHERE cxcm.bulk_customer_id = 2000014074
        AND cxcm.booking_date < now()
        
        AND te.event_code <> 'ITEM_DELIVERY'
        AND te.event_code <> 'ITEM_BOOK'
--        AND te.event_date BETWEEN parseDateTime64BestEffort('2025-07-31 00:00:00.000000') 
--                             AND parseDateTime64BestEffort('2025-08-09 23:59:59.000000')
--                              
      AND cxcm.article_number IN (
  'MS009507205IN',
'MS009507214IN',
'MS009507228IN',
'MS009507231IN',
'MS009507245IN',
'MS009507259IN',
'MS009507262IN',
'MS009507276IN',
'MS009507280IN',
'MS009507293IN',
'MS009507302IN',
'MS009507316IN',
'MS009507320IN',
'MS009507333IN',
'MS009507347IN',
'MS009507355IN',
'MS009507364IN',
'MS009507378IN',
'MS009507381IN',
'MS009507395IN',
'MS009507404IN',
'MS009507418IN',
'MS009507421IN',
'MS009507435IN',
'MS009507449IN',
'MS009507452IN',
'MS009507466IN',
'MS009507470IN',
'MS009507483IN',
'MS009507497IN',
'MS009507506IN',
'MS009507510IN',
'MS009507523IN',
'MS009507537IN',
'MS009507545IN',
'MS009507554IN',
'MS009507568IN',
'MS009507571IN',
'MS009507585IN',
'MS009507599IN',
'MS009507608IN',
'MS009507611IN',
'MS009507625IN',
'MS009507639IN',
'MS009507642IN',
'MS009507656IN',
'MS009507660IN',
'MS009507673IN',
'MS009507687IN',
'MS009507695IN',
'MS009507700IN',
'MS009507713IN',
'MS009507727IN',
'MS009507735IN',
'MS009507744IN',
'MS009507758IN',
'MS009507761IN',
'MS009507775IN',
'MS009507789IN',
'MS009507792IN',
'MS009507801IN',
'MS009507815IN',
'MS009507829IN',
'MS009507832IN',
'MS009507846IN',
'MS009507850IN',
'MS009507863IN',
'MS009507877IN',
'MS009507885IN',
'MS009507894IN',
'MS009507903IN',
'MS009507917IN',
'MS009507925IN',
'MS009507934IN',
'MS009507948IN',
'MS009507951IN',
'MS009507965IN',
'MS009507979IN',
'MS009507982IN',
'MS009507996IN',
'MS009508002IN',
'MS009508016IN',
'MS009508020IN',
'MS009508033IN',
'MS009508047IN',
'MS009508055IN',
'MS009508064IN',
'MS009508078IN',
'MS009508081IN',
'MS009508095IN',
'MS009508104IN',
'MS009508118IN',
'MS009508121IN',
'MS009508135IN',
'MS009508149IN',
'MS009508152IN',
'MS009508166IN',
'MS009508170IN',
'MS009508183IN',
'MS009508197IN',
'MS009508206IN',
'MS009508210IN',
'MS009508223IN',
'MS009508237IN',
'MS009508245IN',
'MS009508254IN',
'MS009508268IN',
'MS009508271IN',
'MS009508285IN',
'MS009508299IN',
'MS009508308IN',
'MS009508311IN',
'MS009508325IN',
'MS009508339IN',
'MS009508342IN',
'MS009508356IN',
'MS009508360IN',
'MS009508373IN',
'MS009508387IN',
'MS009508395IN',
'MS009508400IN',
'MS009508413IN',
'MS009508427IN',
'MS009508435IN',
'MS009508444IN',
'MS009508458IN',
'MS009508461IN',
'MS009508475IN',
'MS009508489IN',
'MS009508492IN',
'MS009508501IN',
'MS009508515IN',
'MS009508529IN',
'MS009508532IN',
'MS009508546IN',
'MS009508550IN',
'MS009508563IN',
'MS009508577IN',
'MS009508585IN',
'MS009508594IN',
'MS009508603IN',
'MS009508617IN',
'MS009508625IN',
'MS009508634IN',
'MS009508648IN',
'MS009508651IN',
'MS009508665IN',
'MS009508679IN',
'MS009508682IN',
'MS009508696IN',
'MS009508705IN',
'MS009508719IN',
'MS009508722IN',
'MS010646505IN',
'MS010646553IN',
'MS010646567IN',
'MS010646575IN',
'MS010646584IN',
'MS010646598IN',
'MS010646607IN',
'MS010646638IN',
'MS010646641IN',
'MS010646655IN',
'MS010646669IN',
'MS010646672IN',
'MS010646686IN',
'MS010646730IN',
'MS010646743IN',
'MS010646774IN',
'MS010646788IN',
'MS010646791IN',
'MS010646805IN',
'MS010646814IN',
'MS010646828IN',
'MS010646933IN',
'MS010646947IN',
'MS010646955IN',
'MS010646964IN',
'MS010646995IN',
'MS010647001IN',
'MS010647032IN',
'MS010647046IN',
'MS010647050IN',
'MS010647063IN',
'MS010647077IN',
'MS010647085IN',
'MS010647117IN',
'MS010647125IN',
'MS010647134IN',
'MS010647148IN',
'MS010647151IN',
'MS010647165IN',
'MS010647179IN',
'MS010647182IN',
'MS010647196IN',
'MS010647205IN',
'MS010647219IN',
'MS010647222IN',
'MS010647236IN',
'MS010647240IN',
'MS010647390IN',
'MS010647409IN',
'MS010647412IN',
'MS010647426IN',
'MS010647430IN',
'MS010647443IN',
'MS010647457IN',
'MS010647465IN',
'MS010647474IN',
'MS010647488IN',
'MS010647491IN',
'MS010647505IN',
'MS010647514IN',
'MS010647528IN',
'MS010647531IN',
'MS010647545IN',
'MS010647593IN',
'MS010647602IN',
'MS010647616IN',
'MS010647620IN',
'MS010647633IN',
'MS010647647IN',
'MS010647655IN',
'MS010647664IN',
'MS010647678IN',
'MS010647681IN',
'MS010647718IN',
'MS010647721IN',
'MS010647770IN',
'MS010647783IN',
'MS010647797IN',
'MS010647806IN',
'MS010647810IN',
'MS010647823IN',
'MS010647854IN',
'MS010647868IN',
'MS010647871IN',
'MS010647885IN',
'MS010647939IN',
'MS010647942IN',
'MS010648038IN',
'MS010648041IN',
'MS010648055IN',
'MS010648069IN',
'MS010648090IN',
'MS010648109IN',
'MS010648112IN',
'MS010648126IN',
'MS010648130IN',
'MS010648143IN',
'MS010648157IN',
'MS010648165IN',
'MS010648174IN',
'MS010648188IN',
'MS010648191IN',
'MS010648205IN',
'MS010648214IN',
'MS010648228IN',
'MS010648231IN',
'MS010648245IN',
'MS010648259IN',
'MS010648262IN',
'MS010648276IN',
'MS010648280IN',
'MS010648293IN',
'MS010648302IN',
'MS010648316IN',
'MS010648320IN',
'MS010648333IN',
'MS010648347IN',
'MS010648355IN',
'MS010648364IN',
'MS010648378IN',
'MS010648381IN',
'MS010648395IN',
'MS010648404IN',
'MS010648435IN',
'MS010648449IN',
'MS010648452IN',
'MS010648466IN',
'MS010648497IN',
'MS010648506IN',
'MS010648510IN',
'MS010648523IN',
'MS010648571IN',
'MS010648585IN',
'MS010648639IN',
'MS010648642IN',
'MS010648656IN',
'MS010648660IN',
'MS010648673IN',
'MS010648687IN',
'MS010648695IN',
'MS010648700IN',
'MS010648713IN',
'MS010648727IN',
'MS010648775IN',
'MS010648789IN',
'MS010648792IN',
'MS010648801IN',
'MS010648815IN',
'MS010648829IN',
'MS010648832IN',
'MS010648846IN',
'MS010648850IN',
'MS010648863IN',
'MS010648934IN',
'MS010648948IN',
'MS010648951IN',
'MS010648965IN',
'MS010648979IN',
'MS010648982IN',
'MS010649016IN',
'MS010649020IN',
'MS010649033IN',
'MS010649047IN',
'MS010649095IN',
'MS010649104IN',
'MS010649170IN',
'MS010649183IN',
'MS010649210IN',
'MS010649223IN',
'MS010649237IN',
'MS010649245IN',
'MS010649254IN',
'MS010649268IN',
'MS010649271IN',
'MS010649285IN',
'MS010649299IN',
'MS010649308IN',
'MS010649311IN',
'MS010649325IN',
'MS010649339IN',
'MS010649342IN',
'MS010649356IN',
'MS010649360IN',
'MS010649373IN',
'MS010649387IN',
'MS010649395IN',
'MS010649400IN',
'MS010649413IN',
'MS010649427IN',
'MS010649435IN',
'MS010649444IN',
'MS010649458IN',
'MS010649461IN',
'MS010649475IN',
'MS010649489IN',
'MS010649492IN',
'MS010649501IN',
'MS010649515IN',
'MS010649529IN',
'MS010649532IN',
'MS010649546IN',
'MS010649577IN',
'MS010649585IN',
'MS010649594IN',
'MS010649603IN',
'MS010649617IN',
'MS010649625IN',
'MS010649634IN',
'MS010649648IN',
'MS010649651IN',
'MS010649665IN',
'MS010649679IN',
'MS010649682IN',
'MS010649696IN',
'MS010649705IN',
'MS010649719IN',
'MS010649722IN',
'MS010649736IN',
'MS010649740IN',
'MS010649753IN',
'MS010649767IN',
'MS010649775IN',
'MS010649784IN',
'MS010649815IN',
'MS010649824IN',
'MS010649838IN',
'MS010649841IN',
'MS010649855IN',
'MS010649869IN',
'MS010649872IN',
'MS010649886IN',
'MS010649890IN',
'MS010649909IN',
'MS010649912IN',
'MS010649926IN',
'MS010649930IN',
'MS010649943IN',
'MS010649957IN',
'MS010649965IN',
'MS010649974IN',
'MS010649988IN',
'MS010649991IN',
'MS010650005IN',
'MS010650014IN',
'MS010650028IN',
'MS010650031IN',
'MS010650045IN',
'MS010650076IN',
'MS010650080IN',
'MS010650093IN',
'MS010650102IN',
'MS010650116IN',
'MS010650120IN',
'MS010650133IN',
'MS010650147IN',
'MS010650155IN',
'MS010650164IN',
'MS010650178IN',
'MS010650181IN',
'MS010650195IN',
'MS010650204IN',
'MS010650218IN',
'MS010650221IN',
'MS010650235IN',
'MS010650249IN',
'MS010650252IN',
'MS010650266IN',
'MS010650270IN',
'MS010650283IN',
'MS010650297IN',
'MS010650306IN',
'MS010650310IN',
'MS010650323IN',
'MS010650337IN',
'MS010650345IN',
'MS010650354IN',
'MS010650368IN',
'MS010650371IN',
'MS010650385IN',
'MS010650399IN',
'MS010650408IN',
'MS010650411IN',
'MS010650425IN',
'MS010650439IN',
'MS010650442IN',
'MS010650456IN',
'MS010650460IN',
'MS010650473IN',
'MS010650487IN',
'MS010650495IN',
'MS010650500IN',
'MS010650558IN',
'MS010650561IN',
'MS010650575IN',
'MS010650589IN',
'MS010650592IN',
'MS010650601IN',
'MS010650632IN',
'MS010650646IN',
'MS010650677IN',
'MS010650685IN',
'MS010650694IN',
'MS010650703IN',
'MS010650717IN',
'MS010650725IN',
'MS010650751IN',
'MS010650765IN',
'MS010650819IN',
'MS010650822IN',
'MS010650898IN',
'MS010650907IN',
'MS010650990IN',
'MS010651006IN',
'MS010651010IN',
'MS010651023IN',
'MS010651037IN',
'MS010651045IN',
'MS010651099IN',
'MS010651108IN',
'MS010651111IN',
'MS010651125IN',
'MS010651139IN',
'MS010651142IN',
'MS010651156IN',
'MS010651160IN',
'MS010651173IN',
'MS010651187IN',
'MS010651195IN',
'MS010651200IN',
'MS010651235IN',
'MS010651244IN',
'MS010651258IN',
'MS010651261IN',
'MS010651275IN',
'MS010651289IN',
'MS010651292IN',
'MS010651301IN',
'MS010651315IN',
'MS010651329IN',
'MS010651332IN',
'MS010651346IN',
'MS010651350IN',
'MS010651363IN',
'MS010651377IN',
'MS010651385IN',
'MS010651394IN',
'MS010651403IN',
'MS010651417IN',
'MS010651425IN',
'MS010651434IN',
'MS010651448IN',
'MS010651451IN',
'MS010651465IN',
'MS010651479IN',
'MS010651482IN',
'MS010651519IN',
'MS010651522IN',
'MS010651536IN',
'MS009508736IN',
'MS009508740IN',
'MS009508753IN',
'MS009508767IN',
'MS009508775IN',
'MS009508784IN',
'MS009508798IN',
'MS009508807IN',
'MS009508815IN',
'MS009508824IN',
'MS009508838IN',
'MS009508841IN',
'MS009508855IN',
'MS009508869IN',
'MS009508872IN',
'MS009508886IN',
'MS009508890IN',
'MS009508909IN',
'MS009508912IN',
'MS009508926IN',
'MS009508930IN',
'MS009508943IN',
'MS009508957IN',
'MS009508965IN',
'MS009508974IN',
'MS009508988IN',
'MS009508991IN',
'MS009509008IN',
'MS009509011IN',
'MS009509025IN',
'MS009509039IN',
'MS009509042IN',
'MS009509056IN',
'MS009509060IN',
'MS009509073IN',
'MS009509087IN',
'MS009509095IN',
'MS009509100IN',
'MS009509113IN',
'MS009509127IN',
'MS009509135IN',
'MS009509144IN',
'MS009509158IN',
'MS009509161IN',
'MS010618172IN',
'MS010618186IN',
'MS010618376IN',
'MS010618380IN',
'MS010618455IN',
'MS010618464IN',
'MS010618478IN',
'MS010618481IN',
'MS010618597IN',
'MS010618606IN',
'MS010618699IN',
'MS010618708IN',
'MS010618756IN',
'MS010618760IN',
'MS010618773IN',
'MS010618787IN',
'MS010618813IN',
'MS010618827IN',
'MS010618892IN',
'MS010618901IN',
'MS010618932IN',
'MS010618946IN',
'MS010618977IN',
'MS010618985IN',
'MS010619031IN',
'MS010619045IN',
'MS010619059IN',
'MS010619062IN',
'MS010619093IN',
'MS010619102IN',
'MS010619235IN',
'MS010619249IN',
'MS010619270IN',
'MS010619283IN',
'MS010619310IN',
'MS010619323IN',
'MS010619371IN',
'MS010619385IN',
'MS010619456IN',
'MS010619460IN',
'MS010619473IN',
'MS010619487IN',
'MS010619513IN',
'MS010619527IN',
'MS010619535IN',
'MS010619544IN',
'MS010619575IN',
'MS010619589IN',
'MS010619592IN',
'MS010619601IN',
'MS010619615IN',
'MS010619629IN',
'MS010619632IN',
'MS010619646IN',
'MS010619650IN',
'MS010619663IN',
'MS010619734IN',
'MS010619748IN',
'MS010619751IN',
'MS010619765IN',
'MS010619819IN',
'MS010619822IN',
'MS010619898IN',
'MS010619907IN',
'MS010619938IN',
'MS010619941IN',
'MS010619955IN',
'MS010619969IN',
'MS010620114IN',
'MS010620128IN',
'MS010620233IN',
'MS010620247IN',
'MS010620255IN',
'MS010620264IN',
'MS010620295IN',
'MS010620304IN',
'MS010620318IN',
'MS010620321IN',
'MS010620352IN',
'MS010620366IN',
'MS010620410IN',
'MS010620423IN',
'MS010620454IN',
'MS010620468IN',
'MS010620499IN',
'MS010620508IN',
'MS010620556IN',
'MS010620560IN',
'MS010620595IN',
'MS010620600IN',
'MS010620613IN',
'MS010620627IN',
'MS010620635IN',
'MS010620644IN',
'MS010620658IN',
'MS010620661IN',
'MS010620692IN',
'MS010620701IN',
'MS010620732IN',
'MS010620746IN',
'MS010620777IN',
'MS010620785IN',
'MS010620919IN',
'MS010620922IN',
'MS010620975IN',
'MS010620984IN',
'MS010621035IN',
'MS010621049IN',
'MS010621052IN',
'MS010621066IN',
'MS010621137IN',
'MS010621145IN',
'MS010621154IN',
'MS010621168IN',
'MS010621171IN',
'MS010621185IN',
'MS010621199IN',
'MS010621208IN',
'MS010621211IN',
'MS010621225IN',
'MS010621256IN',
'MS010621260IN',
'MS010621273IN',
'MS010621287IN',
'MS010621295IN',
'MS010621300IN',
'MS010621358IN',
'MS010621361IN',
'MS010621392IN',
'MS010621401IN',
'MS010621415IN',
'MS010621429IN',
'MS010621432IN',
'MS010621446IN',
'MS010621450IN',
'MS010621463IN',
'MS010621494IN',
'MS010621503IN',
'MS010621534IN',
'MS010621548IN',
'MS010621551IN',
'MS010621565IN',
'MS010621579IN',
'MS010621582IN',
'MS010621653IN',
'MS010621667IN',
'MS010621675IN',
'MS010621684IN',
'MS010621738IN',
'MS010621741IN',
'MS010621755IN',
'MS010621769IN',
'MS010621772IN',
'MS010621786IN',
'MS010621812IN',
'MS010621826IN',
'MS010621830IN',
'MS010621843IN',
'MS010621857IN',
'MS010621865IN',
'MS010621874IN',
'MS010621888IN',
'MS010621914IN',
'MS010621928IN',
'MS010621931IN',
'MS010621945IN',
'MS010621976IN',
'MS010621980IN',
'MS010622115IN',
'MS010622129IN',
'MS010622132IN',
'MS010622146IN',
'MS010622251IN',
'MS010622265IN',
'MS010622415IN',
'MS010622424IN',
'MS010622438IN',
'MS010622441IN',
'MS010622512IN',
'MS010622526IN',
'MS010622530IN',
'MS010622543IN',
'MS010622574IN',
'MS010622588IN',
'MS010622716IN',
'MS010622720IN',
'MS010622755IN',
'MS010622764IN',
'MS010622778IN',
'MS010622781IN',
'MS010622870IN',
'MS010622883IN',
'MS010622897IN',
'MS010622906IN',
'MS010622954IN',
'MS010622968IN',
'MS010622971IN',
'MS010622985IN',
'MS010623053IN',
'MS010623067IN',
'MS010623075IN',
'MS010623084IN',
'MS010623115IN',
'MS010623124IN',
'MS010623155IN',
'MS010623169IN',
'MS010623230IN',
'MS010623243IN',
'MS010623274IN',
'MS010623288IN',
'MS010623291IN',
'MS010623305IN',
'MS010623314IN',
'MS010623328IN',
'MS010623331IN',
'MS010623345IN',
'MS010623359IN',
'MS010623362IN',
'MS010623393IN',
'MS010623402IN',
'MS010623455IN',
'MS010623464IN',
'MS010623518IN',
'MS010623521IN',
'MS010623535IN',
'MS010623549IN',
'MS010623552IN',
'MS010623566IN',
'MS010623597IN',
'MS010623606IN',
'MS010623610IN',
'MS010623623IN',
'MS010623711IN',
'MS010623725IN',
'MS010623739IN',
'MS010623742IN',
'MS010623835IN',
'MS010623844IN',
'MS010623892IN',
'MS010623901IN',
'MS010623932IN',
'MS010623946IN',
'MS010624076IN',
'MS010624080IN',
'MS010624155IN',
'MS010624164IN',
'MS010624218IN',
'MS010624221IN',
'MS010624297IN',
'MS010624306IN',
'MS010624371IN',
'MS010624385IN',
'MS010624456IN',
'MS010624460IN',
'MS010624535IN',
'MS010624544IN',
'MS010624650IN',
'MS010624663IN',
'MS010624717IN',
'MS010624725IN',
'MS010624734IN',
'MS010624748IN',
'MS010624751IN',
'MS010624765IN',
'MS010624819IN',
'MS010624822IN',
'MS010624853IN',
'MS010624867IN',
'MS010624875IN',
'MS010624884IN',
'MS010625037IN',
'MS010625045IN',
'MS010625071IN',
'MS010625085IN',
'MS010625139IN',
'MS010625142IN',
'MS010625173IN',
'MS010625187IN',
'MS010625195IN',
'MS010625200IN',
'MS010625213IN',
'MS010625227IN',
'MS010625292IN',
'MS010625301IN',
'MS010625332IN',
'MS010625346IN',
'MS010625350IN',
'MS010625363IN',
'MS010625377IN',
'MS010625385IN',
'MS010625394IN',
'MS010625403IN',
'MS010625496IN',
'MS010625505IN',
'MS010625553IN',
'MS010625567IN',
'MS010625575IN',
'MS010625584IN',
'MS010625598IN',
'MS010625607IN',
'MS010625638IN',
'MS010625641IN',
'MS010625655IN',
'MS010625669IN',
'MS010625672IN',
'MS010625686IN',
'MS010625712IN',
'MS010625726IN',
'MS010625774IN',
'MS010625788IN',
'MS010625859IN',
'MS010625862IN',
'MS010625893IN',
'MS010625902IN',
'MS010626015IN',
'MS010626029IN',
'MS010626050IN',
'MS010626063IN',
'MS010626117IN',
'MS010626125IN',
'MS010626151IN',
'MS010626165IN',
'MS010626219IN',
'MS010626222IN',
'MS010626275IN',
'MS010626284IN',
'MS010626315IN',
'MS010626324IN',
'MS010626338IN',
'MS010626341IN',
'MS010626491IN',
'MS010626505IN',
'MS010626576IN',
'MS010626580IN',
'MS010626616IN',
'MS010626620IN',
'MS010626633IN',
'MS010626647IN',
'MS010626655IN',
'MS010626664IN',
'MS010626678IN',
'MS010626681IN',
'MS010626695IN',
'MS010626704IN',
'MS010626735IN',
'MS010626749IN',
'MS010626770IN',
'MS010626783IN',
'MS010626911IN',
'MS010626925IN',
'MS010627015IN',
'MS010627024IN',
'MS010627276IN',
'MS010627280IN',
'MS010627418IN',
'MS010627421IN',
'MS010627435IN',
'MS010627449IN',
'MS010628210IN',
'MS010628223IN',
'MS010628594IN',
'MS010628603IN',
'MS010629113IN',
'MS010629127IN',
'MS010629351IN',
'MS010629365IN',
'MS010629657IN',
'MS010662176IN',
'MS010662180IN',
'MS010662193IN',
'MS010662202IN',
'MS010662216IN',
'MS010662220IN',
'MS010662233IN',
'MS010662247IN',
'MS010662255IN',
'MS010662264IN',
'MS010662278IN',
'MS010662281IN',
'MS010662295IN',
'MS010662304IN',
'MS010662335IN',
'MS010662349IN',
'MS010662352IN',
'MS010662366IN',
'MS010662370IN',
'MS010662383IN',
'MS010662397IN',
'MS010662406IN',
'MS010662410IN',
'MS010662423IN',
'MS010662437IN',
'MS010662445IN',
'MS010662454IN',
'MS010662468IN',
'MS010662471IN',
'MS010662485IN',
'MS010662499IN',
'MS010662508IN',
'MS010662511IN',
'MS010662525IN',
'MS010662539IN',
'MS010662542IN',
'MS010662556IN',
'MS010662560IN',
'MS010662595IN',
'MS010662600IN',
'MS010662613IN',
'MS010662627IN',
'MS010662692IN',
'MS010662701IN',
'MS010662715IN',
'MS010662729IN',
'MS010662732IN',
'MS010662746IN',
'MS010662777IN',
'MS010662785IN',
'MS010662794IN',
'MS010662803IN',
'MS010662817IN',
'MS010662825IN',
'MS010662834IN',
'MS010662848IN',
'MS010662879IN',
'MS010662882IN',
'MS010662896IN',
'MS010662905IN',
'MS010662919IN',
'MS010662922IN',
'MS010662936IN',
'MS010662940IN',
'MS010662975IN',
'MS010662984IN',
'MS010662998IN',
'MS010663004IN',
'MS010663018IN',
'MS010663021IN',
'MS010663052IN',
'MS010663066IN',
'MS010663070IN',
'MS010663083IN',
'MS010663097IN',
'MS010663106IN',
'MS010663110IN',
'MS010663123IN'
      )
--      
) AS ranked
WHERE rn = 1