explain analyze SELECT (to_char(be.transaction_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, be.event_type AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, be.bag_number, be.user_id FROM bagmgmt.bag_event be JOIN bagmgmt.kafka_office_master from_office ON be.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON be.to_office_id = to_office.office_id WHERE be.bag_number IN ( SELECT bag_number FROM bagmgmt.bag_close_content WHERE article_number = $1 UNION ALL SELECT bag_number FROM bagmgmt.bag_open_content WHERE article_number = $1 AND NOT EXISTS ( SELECT 1 FROM bagmgmt.bag_close_content WHERE article_number = $1)) UNION ALL SELECT (to_char(art_stg_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'fetched' AS article_status, booking_office_name from_office_name, booking_office_name to_office_name, '' as bag_number, CAST(NULLIF(created_by, '') AS int) AS user_id FROM bagmgmt.article_induction_stg WHERE article_number = $1 AND induction_channel_id <> 'BO'  UNION ALL SELECT (to_char(art_stg_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'pending' AS article_status, booking_office_name from_office_name, booking_office_name to_office_name, '' as bag_number, CAST(created_by AS int) as user_id FROM bagmgmt.article_induction_stg WHERE article_number = $1 AND induction_channel_id <> 'BO'  AND article_status='PD' UNION ALL SELECT (to_char(md_updated_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'booked' AS article_status, origin_office_name from_office_name, destination_office_name to_office_name, '' as bag_number, 0 as user_id FROM bagmgmt.kafka_mailbooking_dom WHERE article_number = $1 UNION ALL SELECT (to_char(ba.delivery_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, CASE WHEN ba.delivery_status = 'D' THEN 'Bulk Delivered' WHEN ba.delivery_status = 'N' THEN 'Bulk Not Delivered' WHEN ba.delivery_status = 'R' THEN 'Return of Bulk Delivery Article' END AS article_status, from_office_name, (SELECT be.customer_name from bag_event_bulk be where be.customer_id::TEXT = ba.bulk_customer_id limit 1) as to_office_name, bag_number, 0 as user_id FROM bagmgmt.bulk_delivery_article ba WHERE article_number = $1 UNION ALL SELECT (to_char(be.transaction_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'NR' AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, be.bag_number, be.user_id FROM bagmgmt.bag_event be JOIN bagmgmt.kafka_office_master from_office ON be.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON be.to_office_id = to_office.office_id WHERE bag_number IN (select bag_number from bagmgmt.bag_open_content where article_number = $1 and art_status='S') AND event_type IN ('OP','OR') UNION ALL SELECT (to_char(md_updated_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'booked' as article_status, origin_office_name from_office_name, destination_office_name to_office_name, '' as bag_number, 0 as user_id FROM bagmgmt.kafka_mailbooking_ord WHERE article_number = $1 UNION ALL SELECT (to_char(md_updated_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'booked' as article_status, origin_office_name from_office_name, destination_cname to_office_name, '' as bag_number, 0 as user_id FROM bagmgmt.kafka_mailbooking_intl WHERE article_number = $1 UNION ALL SELECT (to_char(be.transaction_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, boc.art_status AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, be.bag_number, be.user_id FROM bagmgmt.bag_event be JOIN bagmgmt.kafka_office_master from_office ON be.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON be.to_office_id = to_office.office_id JOIN bagmgmt.bag_open_content boc ON be.bag_number = boc.bag_number AND be.event_type IN ('OP','OR') WHERE boc.article_number = $1 UNION ALL SELECT (to_char(be.transaction_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, bcc.art_status AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, be.bag_number, be.user_id FROM bagmgmt.bag_event be JOIN bagmgmt.kafka_office_master from_office ON be.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON be.to_office_id = to_office.office_id JOIN bagmgmt.bag_close_content bcc ON be.bag_number = bcc.bag_number AND be.event_type='CL' WHERE bcc.article_number = $1 UNION ALL SELECT DISTINCT ON (di.cml_id) (to_char(di.created_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'MD' AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, CAST(di.cml_id AS varchar) as bag_number, CAST(di.created_by AS int) AS user_id FROM bagmgmt.bag_event be JOIN bagmgmt.mail_list_event ml ON ml.mail_id = be.ml_id and ml.event_type='MD' AND be.event_type='DI' JOIN bagmgmt.departure_info di ON di.cml_id = ml.cml_id JOIN bagmgmt.kafka_office_master from_office ON di.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON di.to_office_id = to_office.office_id JOIN bagmgmt.bag_close_content bcc ON be.bag_number = bcc.bag_number AND be.event_type='DI' WHERE bcc.article_number = $1  UNION ALL SELECT DISTINCT ON (ah.arrival_id) (to_char(ah.created_date, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, 'MA' AS article_status, from_office.office_name from_office_name, to_office.office_name to_office_name, CAST(ah.arrival_id AS varchar) as bag_number, CAST(di.created_by AS int) AS user_id FROM bagmgmt.departure_info di JOIN bagmgmt.arrival_detail ad ON ad.departure_id = di.cml_id JOIN bagmgmt.arrival_header ah ON ah.arrival_id = ad.arrival_id JOIN bagmgmt.kafka_office_master from_office ON ad.from_office_id = from_office.office_id JOIN bagmgmt.kafka_office_master to_office ON ad.to_office_id = to_office.office_id JOIN bagmgmt.mail_list_event mle ON mle.cml_id = di.cml_id AND mle.event_type='MD'  JOIN bagmgmt.bag_event be ON be.ml_id=mle.mail_id AND mle.event_type='MD' AND be.event_type='DI' JOIN bagmgmt.bag_close_content bcc ON be.bag_number = bcc.bag_number AND be.event_type='DI' WHERE bcc.article_number = $1 UNION ALL SELECT (to_char(apcl.changed_on, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS') || 'Z') AS transaction_date, ('pincode changed: ' || apcl.old_pin || ' â†’ ' || apcl.new_pin) AS article_status, from_office.office_name AS from_office_name, '' AS to_office_name, '' AS bag_number, apcl.user_id FROM bagmgmt.article_pin_change_log apcl JOIN bagmgmt.kafka_office_master from_office ON apcl.office_id = from_office.office_id WHERE apcl.article_number = $1, []interface {}=[EY000356938IN])